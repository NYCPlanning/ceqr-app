<Mapbox::CurrentMousePosition @map={{this.map}} as |mapMouseEvent|>
  <Mapbox::IntersectingFeatures
    @map={{this.map}}
    @point={{mapMouseEvent.point}}
    @options={{hash layers=(array layerId)}} as |intersectingFeatures|
  >
    {{#if (and mapMouseEvent.point intersectingFeatures)}}
      <HoverCard @point={{mapMouseEvent.point}}>
        <div class="ui card">
          <div class="content">
            <div class="header">
              {{intersectingFeatures.firstObject.properties.boroname}}
            </div>
            <div class="meta">
              <span>
                Census Tract ID:
                {{intersectingFeatures.firstObject.properties.geoid}}
              </span>
            </div>
            <div class="description">
              <Transportation::StudyAreaMap::CensusTractData
                @geoid={{intersectingFeatures.firstObject.properties.geoid
                }} as |censusData|
              >
                <censusData.loading>
                  <i class="spinner icon"></i>
                </censusData.loading>
                <censusData.loaded as |data|>
                  <div class="header">
                    {{data.count}}
                  </div>
                  <div class="meta">
                    <span>
                      2 days ago
                    </span>
                    <a>
                      {{data.mode}}
                    </a>
                  </div>
                  <p></p>
                </censusData.loaded>
              </Transportation::StudyAreaMap::CensusTractData>
            </div>
          </div>
        </div>
      </HoverCard>
    {{/if}}
  </Mapbox::IntersectingFeatures>
</Mapbox::CurrentMousePosition>