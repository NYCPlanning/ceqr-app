{{!-- 
Get Mona to include correct grades served and citywide & alternative schools
 --}}

<div class="ui secondary pointing menu">
  {{#ui-dropdown class="item" selected=activeSdId onChange=(action (mut activeSdId)) as |execute mapper|}}
    <div class="default text">Subdistrict</div>
    <i class="dropdown icon"></i>
    <div class="menu">
      {{#each results as |sd|}}
        <div data-value="{{map-value mapper sd}}" class="item">
          District {{sd.district}} - Subdistrict {{sd.subdistrict}}
        </div>
      {{/each}}
    </div>
  {{/ui-dropdown}}
  
  <a class="item {{if (eq activeSchoolsLevel 'ps') 'active'}}" {{action (mut activeSchoolsLevel) 'ps'}}>
    Primary Schools
  </a>
  <a class="item {{if (eq activeSchoolsLevel 'is') 'active'}}" {{action (mut activeSchoolsLevel) 'is'}}>
    Intermediate Schools
  </a>
</div>

<table class="ui celled sortable table">
  <thead>
    <tr>
      <th class="six wide">School Name</th>
      <th class="five wide">Address</th>
      <th class="one wide">Grades<br />Served</th>
      <th class="one wide">Enrollment</th>
      <th class="one wide">Target<br />Capacity</th>
      <th class="one wide">Available<br />Seats</th>
      <th class="one wide">Utilization (%)</th>
    </tr>
  </thead>

  {{#if (eq activeSchoolsLevel 'ps')}}
    <tbody>
      {{#each activeSdId.psBuildings as |b|}}
        <tr class={{b.type}}>
          <td>
            <i class="circle icon"></i>
            {{b.name}}
          </td>
          <td>{{b.address}}</td>
          <td>{{b.grades}}</td>
          <td>{{b.enroll}}</td>
          <td>{{if b.capacity b.capacity "N/A"}}</td>
          <td>{{b.seats}}</td>
          <td>{{if b.utilization b.utilization "N/A"}}</td>
        </tr>
      {{/each}}
    </tbody>

    <tfoot>
      <tr>
        <th colspan="3"><em>Totals</em></th>
        <th>{{activeSdId.psEnrollmentTotal}}</th>
        <th>{{activeSdId.psCapacityTotal}}</th>
        <th>{{activeSdId.psSeatsTotal}}</th>
        <th>{{activeSdId.psUtilization}}</th>
      </tr>
    </tfoot>
  {{/if}}

  {{#if (eq activeSchoolsLevel 'is')}}
    <tbody>
      {{#each activeSdId.isBuildings as |b|}}
        <tr class={{b.type}}>
          <td>
            <i class="circle icon"></i>
            {{b.name}}
          </td>
          <td>{{b.address}}</td>
          <td>{{b.grades}}</td>
          <td>{{b.enroll}}</td>
          <td>{{if b.capacity b.capacity "N/A"}}</td>
          <td>{{b.seats}}</td>
          <td>{{if b.utilization b.utilization "N/A"}}</td>
        </tr>
      {{/each}}
    </tbody>

    <tfoot>
      <tr>
        <th colspan="3"><em>Totals</em></th>
        <th>{{activeSdId.isEnrollmentTotal}}</th>
        <th>{{activeSdId.isCapacityTotal}}</th>
        <th>{{activeSdId.isSeatsTotal}}</th>
        <th>{{activeSdId.isUtilization}}</th>
      </tr>
    </tfoot>
  {{/if}}
</table>
